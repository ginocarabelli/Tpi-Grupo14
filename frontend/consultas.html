<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="styles.css">
    <title>Consultas</title>
</head>
<body>
    <main class="container-fluid">
        <nav class="navbar navbar-expand-lg bg-body-primary">
            <div class="container-fluid">
                <a href="index.html" class="navbar-brand">Cine</a>
                <button class="navbar-toggler" data-bs-toggle="collapse" data-bs-targer="#navbarSupport">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-item"><a href="./index.html" class="nav-link">Volver</a></li>
                    </ul>
                </div>
            </div>
        </nav>
        <section class="container-fluid" style="min-height: 80vh;">
            <div class="container-consultas">
                <h1>Consultas SELECT</h1>
                <p>Para ver el resultado de las consultas haga click en en cada enunciado, también está disponible ver el código de cada consulta haciendo click en el símbolo de código</p>
            </div>
            <div class="container-lg">
                <div class="accordion" id="accordion1">
                    <div class="accordion-item">
                      <h2 class="accordion-header">
                        <button class="accordion-button collapsed show" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                          Generos con puntuación mayor a X
                        </button>
                      </h2>
                      <div id="collapseOne" class="accordion-collapse collapse" data-bs-parent="#accordion1">
                        <div class="accordion-body">
                            <div class="enunciado">
                                <p>Mostrar los generos de las películas con puntuacion mayor a X, ordenados por puntuacion promedio</p>
                                <div class="d-flex gap-2 mb-3">
                                    <button class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#myModal">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-code-slash" viewBox="0 0 16 16">
                                        <path d="M10.478 1.647a.5.5 0 1 0-.956-.294l-4 13a.5.5 0 0 0 .956.294zM4.854 4.146a.5.5 0 0 1 0 .708L1.707 8l3.147 3.146a.5.5 0 0 1-.708.708l-3.5-3.5a.5.5 0 0 1 0-.708l3.5-3.5a.5.5 0 0 1 .708 0m6.292 0a.5.5 0 0 0 0 .708L14.293 8l-3.147 3.146a.5.5 0 0 0 .708.708l3.5-3.5a.5.5 0 0 0 0-.708l-3.5-3.5a.5.5 0 0 0-.708 0"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="modal" tabindex="-1" id="myModal">
                                    <div class="modal-dialog">
                                      <div class="modal-content">
                                        <div class="modal-header">
                                          <h5 class="modal-title">Películas con puntuación mayor a X</h5>
                                          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                        </div>
                                        <div class="modal-body">
                                          <code>
                                            CREATE PROC SP_CONSULTA1 <br>
                                            @puntuacion decimal(5,2) <br>
                                            AS <br>
                                                &emsp;SELECT g.genero, p.puntuacion AS puntuacion_promedio <br>
                                                &emsp;FROM Peliculas p <br>
                                                &emsp;JOIN Generos g ON p.id_genero = g.id_genero <br>
                                                &emsp;WHERE p.puntuacion > @puntuacion <br>
                                                &emsp;ORDER BY puntuacion_promedio DESC <br>
                                        </code>
                                        </div>
                                        <div class="modal-footer">
                                          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                          <button type="button" class="btn btn-primary">Aceptar</button>
                                        </div>
                                      </div>
                                    </div>
                                </div>
                            </div>
                            <form id="formConsulta1" class="row g-3">
                                <div class="col-auto">
                                    <input type="number" class="form-control" id="puntuacion" placeholder="Ingrese la puntuación"/>
                                </div>
                                <div class="col-auto">
                                    <button class="btn btn-success" type="submit">Consultar</button>
                                </div>
                            </form>
                            
                        </div>
                        <div class="container">
                            <table class="table">
                                <thead>
                                  <tr>
                                    <th scope="col">Genero</th>
                                    <th scope="col">Puntuacion</th>
                                  </tr>
                                </thead>
                                <tbody id="consulta1"></tbody>
                              </table>
                        </div>
                        
                    </div>
                </div>
                    
                <div class="accordion" id="accordion2">
                    <div class="accordion-item">
                      <h2 class="accordion-header">
                        <button class="accordion-button collapsed show" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                            Clientes que cuenten con menos de 5 reservas
                        </button>
                      </h2>
                      <div id="collapseTwo" class="accordion-collapse collapse" data-bs-parent="#accordion2">
                        <div class="accordion-body">
                            <div class="enunciado">
                                <p>Mostrar el nombre y apellido de los clientes que cuenten con menos de 5 reservas.</p>
                                <div class="d-flex gap-2 mb-3">
                                    <button class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#myModal2">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-code-slash" viewBox="0 0 16 16">
                                        <path d="M10.478 1.647a.5.5 0 1 0-.956-.294l-4 13a.5.5 0 0 0 .956.294zM4.854 4.146a.5.5 0 0 1 0 .708L1.707 8l3.147 3.146a.5.5 0 0 1-.708.708l-3.5-3.5a.5.5 0 0 1 0-.708l3.5-3.5a.5.5 0 0 1 .708 0m6.292 0a.5.5 0 0 0 0 .708L14.293 8l-3.147 3.146a.5.5 0 0 0 .708.708l3.5-3.5a.5.5 0 0 0 0-.708l-3.5-3.5a.5.5 0 0 0-.708 0"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="modal" tabindex="-1" id="myModal2">
                                    <div class="modal-dialog">
                                      <div class="modal-content">
                                        <div class="modal-header">
                                          <h5 class="modal-title">Nombre y apellido de los clientes que cuenten  con menos de 5 reservas</h5>
                                          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                        </div>
                                        <div class="modal-body">
                                          <code>
                                            CREATE PROC SP_CONSULTA2 <br>
                                            AS <br>
                                            &emsp;SELECT c.nombre, c.apellido, COUNT(r.id_reserva) reservas <br>
                                            &emsp;FROM Clientes c <br>
                                            &emsp;JOIN Facturas f ON c.id_cliente = f.id_cliente <br>
                                            &emsp;JOIN Reservas r ON f.id_reserva = r.id_reserva <br>
                                            &emsp;GROUP BY c.id_cliente, c.nombre, c.apellido <br>
                                            &emsp;HAVING COUNT(r.id_reserva) < 5 <br>
                                          </code>
                                        </div>
                                        <div class="modal-footer">
                                          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                          <button type="button" class="btn btn-primary">Aceptar</button>
                                        </div>
                                      </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="container">
                            <table class="table">
                                <thead>
                                  <tr>
                                    <th scope="col">Nombre</th>
                                    <th scope="col">Apellido</th>
                                    <th scope="col">Reservas</th>
                                  </tr>
                                </thead>
                                <tbody id="consulta2">
                                </tbody>
                              </table>
                        </div>
                    </div>
                </div>

                <div class="accordion" id="accordion3">
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                        <button class="accordion-button collapsed show" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                            Ingreso total por sucursal
                        </button>
                        </h2>
                        <div id="collapseThree" class="accordion-collapse collapse" data-bs-parent="#accordion3">
                        <div class="accordion-body">
                            <div class="enunciado">
                                <p>Calcular el ingreso total por sucursal, considerando el precio unitario de los tickets y aplicando cualquier descuento.</p>
                                <div class="d-flex gap-2 mb-3">
                                    <button class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#myModal3">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-code-slash" viewBox="0 0 16 16">
                                        <path d="M10.478 1.647a.5.5 0 1 0-.956-.294l-4 13a.5.5 0 0 0 .956.294zM4.854 4.146a.5.5 0 0 1 0 .708L1.707 8l3.147 3.146a.5.5 0 0 1-.708.708l-3.5-3.5a.5.5 0 0 1 0-.708l3.5-3.5a.5.5 0 0 1 .708 0m6.292 0a.5.5 0 0 0 0 .708L14.293 8l-3.147 3.146a.5.5 0 0 0 .708.708l3.5-3.5a.5.5 0 0 0 0-.708l-3.5-3.5a.5.5 0 0 0-.708 0"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="modal" tabindex="-1" id="myModal3">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title">Ingreso total por sucursal</h5>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                        </div>
                                        <div class="modal-body">
                                            <code>
                                                CREATE PROC SP_CONSULTA3 <br>
                                                AS <br>
                                                &emsp;SELECT Sucursales.nombre AS Sucursal, <br>
                                                &emsp;SUM(Tickets.pre_unitario * (1 - ISNULL(Descuentos.porcentaje_descuento, 0) / 100)) AS IngresoTotal <br>
                                                &emsp;FROM Tickets<br>
                                                &emsp;JOIN Facturas ON Tickets.id_factura = Facturas.id_factura<br>
                                                &emsp;JOIN Reservas ON Facturas.id_reserva = Reservas.id_reserva<br>
                                                &emsp;JOIN SalasFunciones ON Reservas.id_sala_funcion = SalasFunciones.id_sala_funcion<br>
                                                &emsp;JOIN Salas ON SalasFunciones.id_sala = Salas.id_sala<br>
                                                &emsp;JOIN Sucursales ON Salas.id_sucursal = Sucursales.id_sucursal<br>
                                                &emsp;LEFT JOIN Descuentos ON Tickets.id_descuento = Descuentos.id_descuento<br>
                                                &emsp;GROUP BY Sucursales.nombre<br>
                                                &emsp;ORDER BY IngresoTotal DESC<br>
                                            </code>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                            <button type="button" class="btn btn-primary">Aceptar</button>
                                        </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="container">
                            <table class="table">
                                <thead>
                                    <tr>
                                    <th scope="col">Sucursal</th>
                                    <th scope="col">Ingresos Totales</th>
                                    </tr>
                                </thead>
                                <tbody id="consulta3"></tbody>
                                </table>
                        </div>
                    </div>
                </div>

                <div class="accordion" id="accordion4">
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                        <button class="accordion-button collapsed show" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseThree">
                            Vista que muestre los detalles de las funciones
                        </button>
                        </h2>
                        <div id="collapseFour" class="accordion-collapse collapse" data-bs-parent="#accordion4">
                        <div class="accordion-body">
                            <div class="enunciado">
                                <p>Crear una vista que muestre los detalles de las funciones (película, sucursal, horario) y la disponibilidad de asientos.</p>
                                <div class="d-flex gap-2 mb-3">
                                    <button class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#myModal4">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-code-slash" viewBox="0 0 16 16">
                                        <path d="M10.478 1.647a.5.5 0 1 0-.956-.294l-4 13a.5.5 0 0 0 .956.294zM4.854 4.146a.5.5 0 0 1 0 .708L1.707 8l3.147 3.146a.5.5 0 0 1-.708.708l-3.5-3.5a.5.5 0 0 1 0-.708l3.5-3.5a.5.5 0 0 1 .708 0m6.292 0a.5.5 0 0 0 0 .708L14.293 8l-3.147 3.146a.5.5 0 0 0 .708.708l3.5-3.5a.5.5 0 0 0 0-.708l-3.5-3.5a.5.5 0 0 0-.708 0"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="modal" tabindex="-1" id="myModal4">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title">Ingreso total por sucursal</h5>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                        </div>
                                        <div class="modal-body">
                                            <code>
                                                CREATE VIEW SP_CONSULTA4 <br>
                                                AS <br>
                                                &emsp;SELECT Peliculas.titulo AS Pelicula, <br>
                                                &emsp;&emsp;Sucursales.nombre AS Sucursal, <br>
                                                &emsp;&emsp;Funciones.fecha, <br>
                                                &emsp;&emsp;Funciones.horario, <br>
                                                &emsp;&emsp;(SELECT COUNT(*) FROM Asientos WHERE Asientos.id_sala_funcion = SalasFunciones.id_sala_funcion) AS AsientosDisponibles <br>
                                                &emsp;FROM Funciones <br>
                                                &emsp;JOIN Peliculas ON Funciones.id_pelicula = Peliculas.id_pelicula<br>
                                                &emsp;JOIN SalasFunciones ON Funciones.id_funcion = SalasFunciones.id_funcion<br>
                                                &emsp;JOIN Salas ON SalasFunciones.id_sala = Salas.id_sala<br>
                                                &emsp;JOIN Sucursales ON Salas.id_sucursal = Sucursales.id_sucursal<br>
                                            </code>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                            <button type="button" class="btn btn-primary">Aceptar</button>
                                        </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="container">
                            <table class="table">
                                <thead>
                                    <tr>
                                    <th scope="col">Pelicula</th>
                                    <th scope="col">Sucursal</th>
                                    <th scope="col">Fecha</th>
                                    <th scope="col">Horario</th>
                                    <th scope="col">Asientos Disponibles</th>
                                    </tr>
                                </thead>
                                <tbody id="consulta4"></tbody>
                                </table>
                        </div>
                        
                    </div>
                </div>

                <div class="accordion" id="accordion5">
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                        <button class="accordion-button collapsed show" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFive" aria-expanded="false" aria-controls="collapseFive">
                            Peliculas cuya puntuacion es mayor al promedio
                        </button>
                        </h2>
                        <div id="collapseFive" class="accordion-collapse collapse" data-bs-parent="#accordion5">
                        <div class="accordion-body">
                            <div class="enunciado">
                                <p>Listar las películas cuya puntuación es mayor al promedio de las puntuaciones de todas las películas del mismo género.</p>
                                <div class="d-flex gap-2 mb-3">
                                    <button class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#myModal5">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-code-slash" viewBox="0 0 16 16">
                                        <path d="M10.478 1.647a.5.5 0 1 0-.956-.294l-4 13a.5.5 0 0 0 .956.294zM4.854 4.146a.5.5 0 0 1 0 .708L1.707 8l3.147 3.146a.5.5 0 0 1-.708.708l-3.5-3.5a.5.5 0 0 1 0-.708l3.5-3.5a.5.5 0 0 1 .708 0m6.292 0a.5.5 0 0 0 0 .708L14.293 8l-3.147 3.146a.5.5 0 0 0 .708.708l3.5-3.5a.5.5 0 0 0 0-.708l-3.5-3.5a.5.5 0 0 0-.708 0"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="modal" tabindex="-1" id="myModal5">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title">Peliculas cuya puntuacion es mayor al promedio</h5>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                        </div>
                                        <div class="modal-body">
                                            <code>
                                                CREATE PROC SP_CONSULTA5 <br>
                                                AS<br>
                                                &emsp;SELECT Peliculas.titulo, <br>
                                                &emsp;&emsp;Peliculas.puntuacion, <br>
                                                    &emsp;&emsp;Generos.genero<br>
                                                    &emsp;FROM Peliculas<br>
                                                &emsp;JOIN Generos ON Peliculas.id_genero = Generos.id_genero<br>
                                                &emsp;WHERE Peliculas.puntuacion > (SELECT AVG(puntuacion)<br>
                                                &emsp;&emsp;&emsp;FROM Peliculas<br>
                                                &emsp;&emsp;&emsp;WHERE Peliculas.id_genero = Generos.id_genero)<br>
                                            </code>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                            <button type="button" class="btn btn-primary">Aceptar</button>
                                        </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="container">
                            <table class="table">
                                <thead>
                                    <tr>
                                    <th scope="col">Titulo</th>
                                    <th scope="col">Puntuacion</th>
                                    <th scope="col">Género</th>
                                    </tr>
                                </thead>
                                <tbody id="consulta5"></tbody>
                                </table>
                        </div>
                    </div>
                </div>

                <div class="accordion" id="accordion6">
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                        <button class="accordion-button collapsed show" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSix" aria-expanded="false" aria-controls="collapseSix">
                            Clientes que hayan hecho una reserva para un dia de descuento
                        </button>
                        </h2>
                        <div id="collapseSix" class="accordion-collapse collapse" data-bs-parent="#accordion6">
                        <div class="accordion-body">
                            <div class="enunciado">
                                <p>Se necesita mostrar nombre, apellido y asiento de los clientes que hayan hecho una reserva para un día de descuento</p>
                                <div class="d-flex gap-2 mb-3">
                                    <button class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#myModal6">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-code-slash" viewBox="0 0 16 16">
                                        <path d="M10.478 1.647a.5.5 0 1 0-.956-.294l-4 13a.5.5 0 0 0 .956.294zM4.854 4.146a.5.5 0 0 1 0 .708L1.707 8l3.147 3.146a.5.5 0 0 1-.708.708l-3.5-3.5a.5.5 0 0 1 0-.708l3.5-3.5a.5.5 0 0 1 .708 0m6.292 0a.5.5 0 0 0 0 .708L14.293 8l-3.147 3.146a.5.5 0 0 0 .708.708l3.5-3.5a.5.5 0 0 0 0-.708l-3.5-3.5a.5.5 0 0 0-.708 0"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="modal" tabindex="-1" id="myModal6">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title">Peliculas cuya puntuacion es mayor al promedio</h5>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                        </div>
                                        <div class="modal-body">
                                            <code>
                                                CREATE PROC SP_CONSULTA6 <br>
                                                AS <br>
                                                &emsp;SELECT c.id_cliente, c.nombre + ' ' + c.apellido Cliente, STR(a.enumeracion) + fila Asiento, STR(d.porcentaje_descuento) + '%' Descuento, COUNT(r.id_reserva) Reservas<br>
                                                &emsp;FROM Facturas f<br>
                                                &emsp;JOIN Clientes c ON c.id_cliente = f.id_factura<br>
                                                &emsp;JOIN Reservas r ON r.id_reserva = f.id_reserva<br>
                                                &emsp;JOIN Asientos a ON a.id_asiento = r.id_asiento<br>
                                                &emsp;JOIN Tickets t ON t.id_asiento = r.id_asiento<br>
                                                &emsp;JOIN Descuentos d ON d.id_descuento = t.id_descuento<br>
                                                &emsp;JOIN DiasSemanas ds ON d.id_dia = ds.id_dia<br>
                                                &emsp;JOIN SalasFunciones sf ON sf.id_sala_funcion = r.id_sala_funcion<br>
                                                &emsp;JOIN Funciones fu ON fu.id_funcion = sf.id_funcion<br>
                                                &emsp;WHERE DATEPART(WEEKDAY, fu.fecha) IN (1,2,3)<br>
                                                &emsp;GROUP BY c.id_cliente, c.nombre, c.apellido, a.enumeracion, a.fila, d.porcentaje_descuento<br>
                                            </code>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                            <button type="button" class="btn btn-primary">Aceptar</button>
                                        </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="container">
                            <table class="table">
                                <thead>
                                    <tr>
                                    <th scope="col">Cliente</th>
                                    <th scope="col">Asiento</th>
                                    <th scope="col">Descuento</th>
                                    <th scope="col">Reservas</th>
                                    </tr>
                                </thead>
                                <tbody id="consulta6"></tbody>
                                </table>
                        </div>
                    </div>
                </div>

                <div class="accordion" id="accordion7">
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                        <button class="accordion-button collapsed show" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSeven" aria-expanded="false" aria-controls="collapseSix">
                            Total de ingresos por película
                        </button>
                        </h2>
                        <div id="collapseSeven" class="accordion-collapse collapse" data-bs-parent="#accordion7">
                        <div class="accordion-body">
                            <div class="enunciado">
                                <p>Calcular el total de ingresos generados por cada película en función de la suma de los precios de los tickets vendidos incluidas aquellas que recaudaron $0</p>
                                <div class="d-flex gap-2 mb-3">
                                    <button class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#myModal7">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-code-slash" viewBox="0 0 16 16">
                                        <path d="M10.478 1.647a.5.5 0 1 0-.956-.294l-4 13a.5.5 0 0 0 .956.294zM4.854 4.146a.5.5 0 0 1 0 .708L1.707 8l3.147 3.146a.5.5 0 0 1-.708.708l-3.5-3.5a.5.5 0 0 1 0-.708l3.5-3.5a.5.5 0 0 1 .708 0m6.292 0a.5.5 0 0 0 0 .708L14.293 8l-3.147 3.146a.5.5 0 0 0 .708.708l3.5-3.5a.5.5 0 0 0 0-.708l-3.5-3.5a.5.5 0 0 0-.708 0"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="modal" tabindex="-1" id="myModal7">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title">Total de ingresos generados por pelicula</h5>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                        </div>
                                        <div class="modal-body">
                                            <code>
                                                CREATE PROC SP_CONSULTA7 <br>
                                                AS <br>
                                                &emsp;SELECT Peliculas.titulo, <br>
                                                &emsp;&emsp;COALESCE(SUM(Tickets.pre_unitario), 0) AS TotalIngresos<br>
                                                &emsp;FROM Peliculas<br>
                                                &emsp;LEFT JOIN Funciones ON Peliculas.id_pelicula = Funciones.id_pelicula<br>
                                                &emsp;LEFT JOIN SalasFunciones ON Funciones.id_funcion = SalasFunciones.id_funcion<br>
                                                &emsp;LEFT JOIN Tickets ON SalasFunciones.id_sala_funcion = Tickets.id_sala_funcion<br>
                                                &emsp;GROUP BY Peliculas.titulo<br>
                                                &emsp;ORDER BY TotalIngresos DESC<br>
                                            </code>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                            <button type="button" class="btn btn-primary">Aceptar</button>
                                        </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="container">
                            <table class="table">
                                <thead>
                                    <tr>
                                    <th scope="col">Pelicula</th>
                                    <th scope="col">Total de Ingresos</th>
                                    </tr>
                                </thead>
                                <tbody id="consulta7"></tbody>
                                </table>
                        </div>
                    </div>
                </div>

                <div class="accordion" id="accordion8">
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                        <button class="accordion-button collapsed show" type="button" data-bs-toggle="collapse" data-bs-target="#collapseEight" aria-expanded="false" aria-controls="collapseSix">
                            Directores cuyas peliculas tengan una puntuacion mayor a 9
                        </button>
                        </h2>
                        <div id="collapseEight" class="accordion-collapse collapse" data-bs-parent="#accordion8">
                        <div class="accordion-body">
                            <div class="enunciado">
                                <p>Mostrar los directores cuyas peliculas tengan una puntuación mayor a 9</p>
                                <div class="d-flex gap-2 mb-3">
                                    <button class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#myModal8">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-code-slash" viewBox="0 0 16 16">
                                        <path d="M10.478 1.647a.5.5 0 1 0-.956-.294l-4 13a.5.5 0 0 0 .956.294zM4.854 4.146a.5.5 0 0 1 0 .708L1.707 8l3.147 3.146a.5.5 0 0 1-.708.708l-3.5-3.5a.5.5 0 0 1 0-.708l3.5-3.5a.5.5 0 0 1 .708 0m6.292 0a.5.5 0 0 0 0 .708L14.293 8l-3.147 3.146a.5.5 0 0 0 .708.708l3.5-3.5a.5.5 0 0 0 0-.708l-3.5-3.5a.5.5 0 0 0-.708 0"/>
                                        </svg>
                                    </button>
                                </div>
                                <div class="modal" tabindex="-1" id="myModal8">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title">Total de ingresos generados por pelicula</h5>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                        </div>
                                        <div class="modal-body">
                                            <code>
                                                CREATE PROC SP_CONSULTA8 <br>
                                                AS<br>
                                                &emsp;SELECT d.id_director, d.nombre + ' ' + d.apellido AS director_nombre, 
                                                COUNT(p.id_pelicula) AS cantidad_peliculas,
                                                AVG(p.puntuacion) AS puntuacion_promedio<br>
                                                &emsp;FROM Directores d<br>
                                                &emsp;JOIN Peliculas p ON d.id_director = p.id_director<br>
                                                &emsp;GROUP BY d.id_director, d.nombre, d.apellido<br>
                                                &emsp;HAVING AVG(p.puntuacion) > 9<br>
                                                &emsp;ORDER BY puntuacion_promedio DESC, cantidad_peliculas DESC;<br>
                                            </code>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                            <button type="button" class="btn btn-primary">Aceptar</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="container">
                            <table class="table">
                                <thead>
                                    <tr>
                                    <th scope="col">Director</th>
                                    <th scope="col">Cantidad de Peliculas</th>
                                    <th scope="col">Puntuacion Promedio</th>
                                    </tr>
                                </thead>
                                <tbody id="consulta8"></tbody>
                                </table>
                        </div>
                    </div>
                </div>
                </div>
        </section>
    </main>
    <footer class="bg-dark"><p class="text-light">Todos los derechos reservados © Grupo14</p></footer>
    <script src="scriptConsultas.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>